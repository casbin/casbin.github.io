<!DOCTYPE html><html lang="ru"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Синтаксис для моделей · Casbin</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="- Модель CONF должна иметь по крайней мере четыре раздела: `[request_definition], [policy_definition], [policy_effect], [matchers]`."/><meta name="docsearch:language" content="ru"/><meta property="og:title" content="Синтаксис для моделей · Casbin"/><meta property="og:type" content="website"/><meta property="og:url" content="https://casbin.org/"/><meta property="og:description" content="- Модель CONF должна иметь по крайней мере четыре раздела: `[request_definition], [policy_definition], [policy_effect], [matchers]`."/><meta property="og:image" content="https://casbin.org/img/casbin.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://casbin.org/img/casbin.svg"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="https://cdn.casbin.org/casbin-website/css/monokai-sublime.min.css"/><link rel="alternate" type="application/atom+xml" href="https://casbin.org/blog/atom.xml" title="Casbin Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://casbin.org/blog/feed.xml" title="Casbin Blog RSS Feed"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-119750650-1', 'auto');
              ga('send', 'pageview');
            </script><link rel="stylesheet" href="/css/code-blocks-buttons.css"/><link rel="stylesheet" href="/css/custom.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdn.casbin.org/casbin-website/js/clipboard.js"></script><script type="text/javascript" src="/js/code-blocks-buttons.js"></script><script type="text/javascript" src="/js/disqus.js"></script><script type="text/javascript" src="/js/baidu-analytics.js"></script><script type="text/javascript" src="/js/hotjar.js"></script><script type="text/javascript" src="/js/gitter.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script><script type="text/javascript" src="/js/wwads.js"></script><script type="text/javascript" src="/js/wwads2.js"></script><script type="text/javascript" src="/js/probe.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/ru"><img class="logo" src="/img/casbin.svg" alt="Casbin"/><h2 class="headerTitleWithLogo">Casbin</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/ru/overview" target="_self">Документ</a></li><li class="siteNavGroupActive"><a href="/docs/ru/management-api" target="_self">API</a></li><li class=""><a href="/ru/editor" target="_self">Редактор</a></li><li class="siteNavGroupActive"><a href="/docs/ru/ide-plugins" target="_self">Плагины IDE</a></li><li class=""><a href="https://casdoor.org" target="_self">Single Sign-On (SSO)</a></li><li class=""><a href="https://forum.casbin.com" target="_self">Форум</a></li><li class=""><a href="/ru/help" target="_self">Справка</a></li><li class=""><a href="/blog/" target="_self">Блог</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg" alt="Languages icon"/>Русский</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/en/syntax-for-models">English</a></li><li><a href="/docs/zh-CN/syntax-for-models">中文</a></li><li><a href="/docs/ko/syntax-for-models">한국어</a></li><li><a href="/docs/fr/syntax-for-models">Français</a></li><li><a href="/docs/ja/syntax-for-models">日本語</a></li><li><a href="https://crowdin.com/project/casbin" target="_blank" rel="noreferrer noopener">Помочь перевести</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><li class=""><a href="https://github.com/casbin" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Модель</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Основы</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/ru/overview">Общий обзор</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/get-started">Начать работу</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/how-it-works">Как это работает</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/tutorials">Уроки</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Модель</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/ru/supported-models">Поддерживаемые модели</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/ru/syntax-for-models">Синтаксис для моделей</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/effector">Эффект</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/function">Функция</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/rbac">RBAC</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/rbac-with-pattern">RBAC with Pattern</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/rbac-with-domains">RBAC с доменами</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/rbac-96">Casbin RBAC v.s. RBAC96</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/abac">АДАТ</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/priority-model">Приоритетная модель</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/superadmin">Супер админ</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Хранилище</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/ru/model-storage">Модель хранилища</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/policy-storage">Хранилище политики</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/policy-subset-loading">Загрузка подмножества политик</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Расширения</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/ru/enforcers">Enforcers</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/adapters">Адаптеры</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/watchers">Наблюдатели</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/dispatchers">Диспетчеры</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/role-managers">Менеджеры ролей</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/middlewares">Посредники</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/graphql-middlewares">GraphQL Middlewares</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/cloud-native">Облачные Посредники</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">API</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/ru/api-overview">Обзор API</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/management-api">API управления</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/rbac-api">RBAC API</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/rbac-with-domains-api">RBAC с доменным API</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/rolemanager-api">RoleManager API</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/data-permissions">Права доступа к данным</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Расширенное использование</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/ru/multi-threading">Многопоточность</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/benchmark">Benchmarks</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/performance">Оптимизация производительности</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/k8s">Авторизация Кубернетов</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/envoy">Авторизация служебной ячейки через посланника</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Управление</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/ru/admin-portal">Администратор портала</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/service">Служба Касбина</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/log-error">Обработка журнала и ошибок</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/frontend">Использование интерфейса</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Редактор</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/ru/online-editor">Онлайн-редактор</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/ide-plugins">Плагины IDE</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Ещё</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/ru/adopters">Наши усыновители</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/contributing">Вклад</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/privacy-policy">Политика конфиденциальности</a></li><li class="navListItem"><a class="navItem" href="/docs/ru/terms-of-service">Условия предоставления услуг</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://crowdin.com/project/casbin/ru" target="_blank" rel="noreferrer noopener">Translate</a><h1 id="__docusaurus" class="postHeaderTitle">Синтаксис для моделей</h1></header><article><div><span><ul>
<li><p>Модель CONF должна иметь по крайней мере четыре раздела: <code>[request_definition], [policy_definition], [policy_effect], [matchers]</code>.</p></li>
<li><p>Если модель использует RBAC, следует добавить раздел <code>[role_definition]</code>.</p></li>
<li><p>Модель CONF может содержать комментарии. Комментарии начинаются с <code>#</code>, и <code>#</code> прокомментирует остальную строку.</p></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="определение-запроса"></a><a href="#определение-запроса" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Определение запроса</h2>
<p><code>[request_definition]</code> - это определение запроса доступа. Оно определяет аргументы в <code>e.Enforce(...)</code> функции.</p>
<pre><code class="hljs css language-ini"><span class="hljs-section">[request_definition]</span>
<span class="hljs-attr">r</span> = sub, obj, акт
</code></pre>
<p><code>sub, obj, act</code> представляет классический тройник: доступ к сущности (Subject), доступным ресурсу (Object) и методу доступа (Action). Однако вы можете настроить свою собственную форму запроса, например <code>sub, действовать</code> , если вам не нужно указывать конкретный ресурс, или <code>sub, sub2, obj, поступать</code> если у вас есть два доступных объекта.</p>
<h2><a class="anchor" aria-hidden="true" id="определение-политики"></a><a href="#определение-политики" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Определение политики</h2>
<p><code>[policy_definition]</code> это определение политики. Оно определяет значение политики. Например, у нас есть следующая модель:</p>
<pre><code class="hljs css language-ini"><span class="hljs-section">[policy_definition]</span>
<span class="hljs-attr">p</span> = sub, obj, акт
<span class="hljs-attr">p2</span> = sub, акт
</code></pre>
<p>И у нас есть следующая политика (если в файле политики)</p>
<pre><code class="hljs">p, alice, data1, чтение
p2, bob, write-all-objects
</code></pre>
<p>Каждая строка в политике называется правилом политики. Каждое правило политики начинается с типа ``, например <code>p</code>, <code>p2</code>. Он используется для соответствия политическому определению при наличии нескольких определений. Вышеуказанная политика свидетельствует о нижеследующих обязательствах. Привязка может быть использована в матче.</p>
<pre><code class="hljs">(alice, data1, read) -&gt; (p.sub, p.obj, p.act)
(bob, write-all-objects) -&gt; (p2.sub, p2.act)
</code></pre>
<p>::tip Элементы правила политики всегда рассматриваются как<code>строка</code>. Если у вас есть какие-либо вопросы по этому вопросу, пожалуйста, смотрите обсуждение по адресу <a href="https://github.com/casbin/casbin/issues/113">https://github.com/casbin/casbin/issues/113</a>
:::</p>
<h2><a class="anchor" aria-hidden="true" id="стратегический-эффект"></a><a href="#стратегический-эффект" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Стратегический эффект</h2>
<p><code>[policy_effect]</code> это определение для политического эффекта. Она определяет, должен ли запрос на доступ быть одобрен, если несколько правил политики соответствуют запросу. Например, одно правило разрешает и другое отрицает.</p>
<pre><code class="hljs css language-ini"><span class="hljs-section">[policy_effect]</span>
<span class="hljs-attr">e</span> = где-то (где (p.eft == допустить))
</code></pre>
<p>Вышеприведенный политический эффект означает, если существует какое-либо соответствующее правило политики <code>позволяющее</code>, окончательный эффект <code>разрешить</code> (aka allow-override). <code>p.eft</code> является эффектом для политики, он может быть <code>разрешить</code> или <code>отрицать</code>. Это необязательно, и значение по умолчанию <code>разрешить</code>. Так как мы не указали выше, он использует значение по умолчанию.</p>
<p>Другим примером политического эффекта является:</p>
<pre><code class="hljs css language-ini"><span class="hljs-section">[policy_effect]</span>
<span class="hljs-attr">e</span> = !some(где (p.eft == отрицать))
</code></pre>
<p>Это означает, что если не соответствует правилам<code>отрицать</code>, окончательный эффект <code>позволяет</code> (aka deny-override). <code>некоторые</code> означают: если существует одно соответствующее правило политики. <code>любые</code> означают: все соответствующие правила политики (не используются здесь). Эффект политики может быть даже связан с логическими выражениями:</p>
<pre><code class="hljs css language-ini"><span class="hljs-section">[policy_effect]</span>
<span class="hljs-attr">e</span> = где-то (где (p.eft == разрешить)) &amp;&amp; !где(где (p.eft == отрицать))
</code></pre>
<p>Это означает, что по крайней мере одно соответствующее правило<code>разрешает</code>, и не существует соответствующее правило политики<code>отрицает</code>. Так что таким образом поддерживаются как разрешение, так и отказ в разрешениях, и отказ от разрешений.</p>
<p>::note Хотя мы разработали синтаксис эффекта политики, как и выше, Нынешние реализации используют только жесткий программный эффект, поскольку мы обнаружили, что такой гибкости не надо. Так что на данный момент вы должны использовать один из встроенных эффектов политики, а не настраивать свой собственный эффект.
:::</p>
<p>К числу поддерживаемых встроенных политических последствий относятся:</p>
<table>
<thead>
<tr><th>Стратегический эффект</th><th>Значение</th><th>Пример</th></tr>
</thead>
<tbody>
<tr><td>где-то (где (p.eft == допустить))</td><td>переопределить</td><td><a href="/docs/en/supported-models#examples">ACL, RBAC, и т.д.</a></td></tr>
<tr><td>!some(where (p.eft == deny))</td><td>запретить</td><td><a href="/docs/en/supported-models#examples">Запретить переопределение</a></td></tr>
<tr><td>где-то (где (p.eft == allow)) &amp;&amp; !some(где (p.eft == deny))</td><td>разрешить и запретить</td><td><a href="/docs/en/supported-models#examples">Замедлить и запретить</a></td></tr>
<tr><td>приоритет (p.eft) || отрицание</td><td>приоритет</td><td><a href="/docs/en/supported-models#examples">Приоритет</a></td></tr>
<tr><td>subjectPriority(p.eft)</td><td>приоритет на основе роли</td><td><a href="/docs/en/supported-models#examples">Предмет - Приоритет</a></td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="матчеры"></a><a href="#матчеры" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Матчеры</h2>
<p><code>[matchers]</code> - это определение для вычисления политики. Соответствующие устройства являются выражениями. Оно определяет как правила политики вычисляются против запроса.</p>
<pre><code class="hljs css language-ini"><span class="hljs-section">[matchers]</span>
<span class="hljs-attr">m</span> = r.sub == p.sub &amp;&amp; r.obj == p.obj &amp;&amp; r.act == p.act
</code></pre>
<p>Вышеупомянутый матч прост, это означает, что тема, объект и действие в запросе должны соответствовать правилам политики.</p>
<p>Вы можете использовать арифметические <code>+, -, *, /</code> и логические операторы, такие как <code>&amp;&amp;, |, !</code> в вычислениях.</p>
<h2><a class="anchor" aria-hidden="true" id="несколько-разделов-типа"></a><a href="#несколько-разделов-типа" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Несколько разделов типа</h2>
<p>Если вам нужны несколько определений политики или несколько матчей, вы можете использовать такие определения, как <code>p2</code>, <code>m2</code>. Фактически, все из вышеперечисленных четырех разделов могут использовать несколько типов, а синтаксис <code>r</code>+number, такие как <code>r2</code>, <code>e2</code>. По умолчанию эти четыре секции должны соответствовать одному из них. Например, ваш <code>r2</code> будет использовать только матч <code>m2</code> для соответствия политикам <code>p2</code>.</p>
<p>Вы можете передать в <code>EnforceContext</code> в качестве первого параметра <code>принудительного применения</code> метода для указания типов, <code>EnforceContext</code> это как</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-4336-tab-4337" class="nav-link active" data-group="group_4336" data-tab="tab-group-4336-content-4337">go</div><div id="tab-group-4336-tab-4338" class="nav-link" data-group="group_4336" data-tab="tab-group-4336-content-4338">Node.js</div><div id="tab-group-4336-tab-4339" class="nav-link" data-group="group_4336" data-tab="tab-group-4336-content-4339">Java</div></div><div class="tab-content"><div id="tab-group-4336-content-4337" class="tab-pane active" data-group="group_4336" tabindex="-1"><div><span><pre><code class="hljs css language-go">EnforceContext{<span class="hljs-string">"r2"</span>,<span class="hljs-string">"p2"</span>,<span class="hljs-string">"e2"</span>,<span class="hljs-string">"m2"</span>}<br /><span class="hljs-keyword">type</span> EnforceContext <span class="hljs-keyword">struct</span> {<br />    RType <span class="hljs-keyword">string</span><br />    PType <span class="hljs-keyword">string</span><br />    EType <span class="hljs-keyword">string</span><br />    MType <span class="hljs-keyword">string</span><br />}<br /></code></pre>
</span></div></div><div id="tab-group-4336-content-4338" class="tab-pane" data-group="group_4336" tabindex="-1"><div><span><pre><code class="hljs css language-javascript"><span class="hljs-keyword">const</span> enforceContext = <span class="hljs-keyword">new</span> EnforceContext(<span class="hljs-string">'r2'</span>, <span class="hljs-string">'p2'</span>, <span class="hljs-string">'e2'</span>, <span class="hljs-string">'m2'</span>);<br /><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EnforceContext</span> </span>{<br />  <span class="hljs-keyword">constructor</span>(rType, pType, eType, mType) {<br />    <span class="hljs-keyword">this</span>.pType = pType;<br />    <span class="hljs-keyword">this</span>.eType = eType;<br />    <span class="hljs-keyword">this</span>.mType = mType;<br />    <span class="hljs-keyword">this</span>.rType = rType;<br />  }<br />}<br /></code></pre>
</span></div></div><div id="tab-group-4336-content-4339" class="tab-pane" data-group="group_4336" tabindex="-1"><div><span><pre><code class="hljs css language-java">EnforceContext enforceContext = новый контекст принудительного обеспечения (<span class="hljs-string">"2"</span>);<br />публичный класс EnforceContext {<br />    <span class="hljs-keyword">private</span> String pType;<br />    <span class="hljs-keyword">private</span> String eType;<br />    приватная строка mType;<br />    частная строка rType;<br />    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">EnforceContext</span><span class="hljs-params">(String suffix)</span> </span>{<br />      <span class="hljs-keyword">this</span>. Тип = <span class="hljs-string">"p"</span> + суффикс;<br />      <span class="hljs-keyword">this</span>.eType = <span class="hljs-string">"e"</span> + суффикс;<br />      это. Тип = <span class="hljs-string">"m"</span> + суффикс;<br />      <span class="hljs-keyword">this</span>.rType = <span class="hljs-string">"r"</span> + суффикс;<br />    }<br />}<br /></code></pre>
</span></div></div></div></div>
<p>Пример использования, см. <a href="https://github.com/casbin/casbin/blob/master/examples/multiple_policy_definitions_model.conf">модель</a> и <a href="https://github.com/casbin/casbin/blob/master/examples/multiple_policy_definitions_policy.csv">политика</a>, запрос приводится следующим образом</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-4340-tab-4341" class="nav-link active" data-group="group_4340" data-tab="tab-group-4340-content-4341">go</div><div id="tab-group-4340-tab-4342" class="nav-link" data-group="group_4340" data-tab="tab-group-4340-content-4342">Node.js</div><div id="tab-group-4340-tab-4343" class="nav-link" data-group="group_4340" data-tab="tab-group-4340-content-4343">Java</div></div><div class="tab-content"><div id="tab-group-4340-content-4341" class="tab-pane active" data-group="group_4340" tabindex="-1"><div><span><pre><code class="hljs css language-go"><span class="hljs-comment">// Передача в суффикс параметра NewEnforceContext,such as 2 or 3 и создаёт r2,p2,p2,etc..</span><br />enforceContext := NewEnforceContext(<span class="hljs-string">"2"</span>)<br /><span class="hljs-comment">// You can also specify a certain type individually</span><br />enforceContext.EType = <span class="hljs-string">"e"</span><br /><span class="hljs-comment">// Don't pass in EnforceContext,the default is r,p,e,m</span><br />e.Enforce(<span class="hljs-string">"alice"</span>, <span class="hljs-string">"data2"</span>, <span class="hljs-string">"read"</span>)     <span class="hljs-comment">// true</span><br /><span class="hljs-comment">// pass in EnforceContext</span><br />e.Enforce(enforceContext, <span class="hljs-keyword">struct</span>{ Age <span class="hljs-keyword">int</span> }{Age: <span class="hljs-number">70</span>}, <span class="hljs-string">"/data1"</span>, <span class="hljs-string">"read"</span>)     <span class="hljs-comment">//false</span><br />e.Enforce(enforceContext, <span class="hljs-keyword">struct</span>{ Age <span class="hljs-keyword">int</span> }{Age: <span class="hljs-number">30</span>}, <span class="hljs-string">"/data1"</span>, <span class="hljs-string">"read"</span>)     <span class="hljs-comment">//true</span><br /></code></pre>
</span></div></div><div id="tab-group-4340-content-4342" class="tab-pane" data-group="group_4340" tabindex="-1"><div><span><pre><code class="hljs css language-javascript"><span class="hljs-comment">// Передача в суффикс параметра NewEnforceContext,such as 2 or 3 и создаёт r2,p2,p2,etc..</span><br /><span class="hljs-keyword">const</span> enforceContext = <span class="hljs-keyword">new</span> NewEnforceContext(<span class="hljs-string">'2'</span>);<br /><span class="hljs-comment">// You can also specify a certain type individually</span><br />enforceContext.eType = <span class="hljs-string">"e"</span><br /><span class="hljs-comment">// Don't pass in EnforceContext,the default is r,p,e,m</span><br />e.Enforce(<span class="hljs-string">"alice"</span>, <span class="hljs-string">"data2"</span>, <span class="hljs-string">"read"</span>)     <span class="hljs-comment">// true</span><br /><span class="hljs-comment">// pass in EnforceContext</span><br />e.Enforce(enforceContext, {<span class="hljs-attr">Age</span>: <span class="hljs-number">70</span>}, <span class="hljs-string">"/data1"</span>, <span class="hljs-string">"read"</span>)      <span class="hljs-comment">//false</span><br />e.Enforce(enforceContext, {<span class="hljs-attr">Age</span>: <span class="hljs-number">30</span>}, <span class="hljs-string">"/data1"</span>, <span class="hljs-string">"read"</span>)      <span class="hljs-comment">//true</span><br /></code></pre>
</span></div></div><div id="tab-group-4340-content-4343" class="tab-pane" data-group="group_4340" tabindex="-1"><div><span><pre><code class="hljs css language-java"><span class="hljs-comment">// Pass in a suffix as parameter to NewEnforceContext,such as 2 or 3 and it will create r2, p2, etc..</span><br />EnforceContext enforceContext = <span class="hljs-keyword">new</span> EnforceContext(<span class="hljs-string">"2"</span>);<br /><span class="hljs-comment">// Вы также можете указать определенный тип</span><br />принудительного контекста. eteType(<span class="hljs-string">"e"</span>);<br /><span class="hljs-comment">// Don't pass in EnforceContext, the default is r, p, e, m</span><br />e. nforce(<span class="hljs-string">"alice"</span>, <span class="hljs-string">"data2"</span>, <span class="hljs-string">"read"</span>); <span class="hljs-comment">// true</span><br /><span class="hljs-comment">// Pass in EnforceContext</span><br /><span class="hljs-comment">// TestEvalRule находится в https://github. om/casbin/jcasbin/blob/master/src/test/java/org/casbin/jcasbin/main/AbacAPIUnitTest.java#L56</span><br />e.enforce(enforceContext, <span class="hljs-keyword">new</span> AbacAPIUnitTest.TestEvalRule(<span class="hljs-string">"alice"</span>, <span class="hljs-number">70</span>), <span class="hljs-string">"/data1"</span>, <span class="hljs-string">"read"</span>); <span class="hljs-comment">// false</span><br />e.enforce(enforceContext, <span class="hljs-keyword">new</span> AbacAPIUnitTest.TestEvalRule(<span class="hljs-string">"alice"</span>, <span class="hljs-number">30</span>), <span class="hljs-string">"/data1"</span>, <span class="hljs-string">"read"</span>); <span class="hljs-comment">// true // true // true</span><br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="special-grammer"></a><a href="#special-grammer" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Special Grammer</h3>
<p>Вы также можете использовать <code>в</code>, единственный оператор с текстовым именем. Этот оператор проверяет правый массив на наличие значения, равного значению левой стороны. Равенство определяется использованием == оператора, и эта библиотека не проверяет типы между значениями. Любые два значения при передаче на интерфейс{}, и все равно могут быть проверены на равенство с == будет действовать как ожидалось. Обратите внимание, что вы можете использовать параметр массива, но он должен быть <code>[]интерфейсом{}</code>.</p>
<p>Также ссылаются на <a href="https://github.com/casbin/casbin/blob/277c1a2b85698272f764d71a94d2595a8d425915/examples/rbac_model_matcher_using_in_op.conf">rbac_model_matcher_using_in_op</a>, <a href="https://github.com/casbin/casbin/blob/277c1a2b85698272f764d71a94d2595a8d425915/examples/keyget2_model.conf">keyget2_model</a> и <a href="https://github.com/casbin/casbin/blob/277c1a2b85698272f764d71a94d2595a8d425915/examples/keyget_model.conf">keyget_model</a></p>
<p>Например:</p>
<pre><code class="hljs css language-ini">[request_definition]
r = sub, obj
...
[matchers]
m = r.sub.name в (r.obj.Admins)
</code></pre>
<pre><code class="hljs css language-go">e.Enforce(Sub{Name: <span class="hljs-string">"alice"</span>}, Obj{Name: <span class="hljs-string">"a book"</span>, Admins: []<span class="hljs-keyword">interface</span>{}{<span class="hljs-string">"alice"</span>, <span class="hljs-string">"bob"</span>}})
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="исполнитель-выражения"></a><a href="#исполнитель-выражения" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Исполнитель выражения</h3>
<p>Оценка совпадений в Casbin осуществляется оценщиками выражений на каждом языке. Касбин объединяет свои возможности для обеспечения единого PERM языка. Кроме того, предложенный здесь синтаксис модели эти выражения могут обеспечить дополнительную функциональность, которая может не поддерживаться другим языком или реализацией. Используйте его на свой страх и риск.</p>
<p>Оценщики выражений, используемые каждой реализацией Casbin являются:</p>
<table>
<thead>
<tr><th>Осуществление</th><th>Язык</th><th>Исполнитель выражения</th></tr>
</thead>
<tbody>
<tr><td>Casbin</td><td>Golang</td><td><a href="https://github.com/Knetic/govaluate">https://github.com/Knetic/govaluate</a></td></tr>
<tr><td>jCasbin</td><td>Java</td><td><a href="https://github.com/killme2008/aviator">https://github.com/killme2008/aviator</a></td></tr>
<tr><td>Node-Casbin</td><td>Node.js</td><td><a href="https://github.com/donmccurdy/expression-eval">https://github.com/donmccurdy/expression-eval</a></td></tr>
<tr><td>PHP-Casbin</td><td>PHP</td><td><a href="https://github.com/symfony/expression-language">https://github.com/symfony/expression-language</a></td></tr>
<tr><td>PyCasbin</td><td>Python</td><td><a href="https://github.com/danthedeckie/simpleeval">https://github.com/danthedeckie/simpleeval</a></td></tr>
<tr><td>Casbin.NET</td><td>C#</td><td><a href="https://github.com/davideicardi/DynamicExpresso">https://github.com/davideicardi/DynamicExpresso</a></td></tr>
<tr><td>Casbin4D</td><td>Дельфи</td><td><a href="https://github.com/casbin4d/Casbin4D/tree/master/SourceCode/Common/Third%20Party/TExpressionParser">https://github.com/casbin4d/Casbin4D/tree/master/SourceCode/Common/Third%20Party/TExpressionParser</a></td></tr>
<tr><td>casbin-rs</td><td>Ржава</td><td><a href="https://github.com/jonathandturner/rhai">https://github.com/jonathandturner/rhai</a></td></tr>
<tr><td>casbin-cpp</td><td>C++</td><td><a href="https://github.com/ArashPartow/exprtk">https://github.com/ArashPartow/exprtk</a></td></tr>
</tbody>
</table>
<p>::note Если вы столкнулись с проблемой производительности Касбина, это, вероятно, вызвано низкой эффективностью оценщика выражения. Вы можете послать запрос Касбину или вычислитель выражений непосредственно для советов по ускорению. Подробности смотрите в разделе <a href="/docs/en/benchmark">Бенчмаркеты</a>.
:::</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/ru/supported-models"><span class="arrow-prev">← </span><span>Поддерживаемые модели</span></a><a class="docs-next button" href="/docs/ru/effector"><span>Эффект</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#определение-запроса">Определение запроса</a></li><li><a href="#определение-политики">Определение политики</a></li><li><a href="#стратегический-эффект">Стратегический эффект</a></li><li><a href="#матчеры">Матчеры</a></li><li><a href="#несколько-разделов-типа">Несколько разделов типа</a><ul class="toc-headings"><li><a href="#special-grammer">Special Grammer</a></li><li><a href="#исполнитель-выражения">Исполнитель выражения</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/casbin.svg" alt="Casbin" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/ru/get-started">Getting Started</a><a href="/docs/ru/management-api">Management API</a><a href="/docs/ru/rbac-api">RBAC API</a><a href="/docs/ru/middlewares">Middlewares</a></div><div><h5>Community</h5><a href="/ru/users">Who&#x27;s using Casbin?</a><a href="https://stackoverflow.com/search?q=casbin" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://www.netlify.com" target="_blank" rel="noreferrer noopener" aria-label="Deploys by Netlify"><img src="https://www.netlify.com/img/global/badges/netlify-color-accent.svg" alt="Deploys by Netlify" width="114" height="51"/></a></div><div><a class="github-button" href="https://github.com/casbin/casbin" data-icon="octicon-star" data-count-href="/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Casbin</a>          <a class="github-button" href="https://github.com/casbin/jcasbin" data-icon="octicon-star" data-count-href="/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">jCasbin</a><br/><a class="github-button" href="https://github.com/casbin/node-casbin" data-icon="octicon-star" data-count-href="/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Node-Casbin</a>   <a class="github-button" href="https://github.com/php-casbin/php-casbin" data-icon="octicon-star" data-count-href="/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">PHP-Casbin</a><a class="github-button" href="https://github.com/casbin/pycasbin" data-icon="octicon-star" data-count-href="/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">PyCasbin</a>          <a class="github-button" href="https://github.com/casbin/Casbin.NET" data-icon="octicon-star" data-count-href="/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Casbin.NET</a><a class="github-button" href="https://github.com/casbin/casbin-cpp" data-icon="octicon-star" data-count-href="/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Casbin-CPP</a>        <a class="github-button" href="https://github.com/casbin/casbin-rs" data-icon="octicon-star" data-count-href="/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Casbin-RS</a><div class="social"><a href="https://twitter.com/casbinHQ" class="twitter-follow-button">Follow @casbinHQ</a></div><div class="social"><div class="fb-like" data-href="https://casbin.org" data-colorscheme="dark" data-layout="standard" data-share="true" data-width="225" data-show-faces="false"></div></div></div></section><section class="copyright">Copyright © 2022 Casbin Organization</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>window.fbAsyncInit = function() {FB.init({appId:'1354585054683583',xfbml:true,version:'v2.7'});};(function(d, s, id){var js, fjs = d.getElementsByTagName(s)[0];if (d.getElementById(id)) {return;}js = d.createElement(s); js.id = id;js.src = '//connect.facebook.net/en_US/sdk.js';fjs.parentNode.insertBefore(js, fjs);}(document, 'script','facebook-jssdk'));
                </script><script>window.twttr=(function(d,s, id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return t;js=d.createElement(s);js.id=id;js.src='https://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js, fjs);t._e = [];t.ready = function(f) {t._e.push(f);};return t;}(document, 'script', 'twitter-wjs'));</script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '2b87bf88e794912bdbe1b08420681efa',
                indexName: 'casbin',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:ru"]}
              });
            </script></body></html>